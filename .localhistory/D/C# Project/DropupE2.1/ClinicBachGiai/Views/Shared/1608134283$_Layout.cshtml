@using Data;
@using Data.Providers;

@{
    var list_benh_nam_khoa = new CategoryProvider().getListBenhNamKhoa();
    var list_benh_xa_hoi = new CategoryProvider().getListBenhXaHoi();
    var list_benh_chinh = new CategoryProvider().getAll().Where(c => (c.status == true && c.show_datetime <= DateTime.Now) && (c.image != "../Assets/img/category_image/Logo Bach Giai.png" && c.image != "../Assets/img/category_image/BG.png"));

    string urlCMS = System.Configuration.ConfigurationManager.AppSettings["urlCMS"];
    string urlSite = System.Configuration.ConfigurationManager.AppSettings["urlSite"];
    string link_chat = "https://tawk.to/chat/5fd72a71df060f156a8cccb0/1epg7rjec?$_tawk_sk=5fd72cbaad69343bd30123c4&$_tawk_tk=fccc8f04b834d927142ad2ae1ef4fde1&v=698";
    string map_link = System.Configuration.ConfigurationManager.AppSettings["map"];
    string zalo_link = System.Configuration.ConfigurationManager.AppSettings["linkZalo"];

    var favicon = new StoreLogoProvider().getFavicon();
    var logo_header = new StoreLogoProvider().getLogoHeader();
    var logo_footer = new StoreLogoProvider().getLogoFooter();
    var logo_mobile = new StoreLogoProvider().getLogoMobile();
    var contact = new StoreContactProvider().get1Contact();
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <link rel="icon" href="@urlCMS/@favicon.image" type="image/x-icon" />
    <title>@ViewBag.Title</title>
    <meta name="keywords" content="@ViewBag.Keywords">
    <meta name="description" content="@ViewBag.Description">
    <meta name="author" content="Diwe.vn">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta property="og:locale" content="vi_VN">
    <meta name="revisit" content="1 days">
    <meta name="robots" content="noodp,index,follow" />

    <!-- Helpers ================================================== -->
    <meta name="apple-mobile-web-app-title" content="Đa khoa Bách Giai">
    <meta name="application-name" content="Đa khoa Bách Giai">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <meta name="theme-color" content="#000">
    <meta name="format-detection" content="telephone=no">
    <meta name="robots" content="noodp,index, follow" />
    <link rel="canonical" href="@ViewBag.Canonical" />
    <link rel="alternate" href="@ViewBag.Alternate" hreflang="vi-vn" />
    <meta itemprop="name" content="@ViewBag.Title">
    <meta itemprop="description" content="@ViewBag.Description">
    <meta property="og:title" content="@ViewBag.Title" />
    <meta property="og:locale" content="vi_VN" />
    <meta property="og:url" content="@ViewBag.Url" />
    <meta property="og:description" content="@ViewBag.Description" />
    <meta property="og:site_name" content="Đa khoa Bách Giai" />
    <meta property="og:image" content="@ViewBag.Image" />
    <meta property="og:type" content="website">
    <meta property="og:image:secure_url" content="@ViewBag.Image" />
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700,800|Dancing+Script:400,700|Caveat:400,700|Roboto+Condensed:300,400,700|Quicksand:300,400,500,600,700,800|Montserrat:300,400,500,600,700,800|Playfair+Display:400,400i,700,900&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,600,600i,700,700i&amp;subset=vietnamese" rel="stylesheet">
    @Styles.Render("~/bundles/styleCore")
    @Scripts.Render("~/bundles/jsCoreFirst")
</head>

<body>
    @*<script>
        var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();
        (function () {
            var s1 = document.createElement("script"), s0 = document.getElementsByTagName("script")[0];
            s1.async = true;
            s1.src = 'https://embed.tawk.to/5fd72a71df060f156a8cccb0/1epg7rjec';
            s1.charset = 'UTF-8';
            s1.setAttribute('crossorigin', '*');
            s0.parentNode.insertBefore(s1, s0);
        })();
    </script>*@

    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v9.0&appId=2746333342249280&autoLogAppEvents=1" nonce="60hQV1vM"></script>
    <!-- Start Top Bar Area -->
    <div class="top-bar-area bg-color hidden-sm hidden-xs">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 col-md-12">
                    <ul class="top-bar-information">
                        <li>
                            <marquee style="margin-top: 5px;">Địa chỉ: @contact.address</marquee>
                        </li>
                    </ul>
                </div>

                <div class="col-lg-6 col-md-12">
                    <ul class="top-bar-optional">
                        <li>
                            <a href="#" target="_blank">
                                <i class='bx bxl-facebook'></i>
                            </a>
                            <a href="#" target="_blank">
                                <i class='bx bxl-twitter'></i>
                            </a>
                            <a href="#" target="_blank">
                                <i class='bx bxl-pinterest-alt'></i>
                            </a>
                            <a href="#" target="_blank">
                                <i class='bx bxl-instagram'></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- End Top Bar Area -->

    <div class="">
        <div class="main-nav-custom" style="background: url(../Assets/images/bg-header.png) bottom center no-repeat">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-lg-6 col-md-6 logo-header-custom">
                        <a class="navbar-brand" href="/">
                            <img class="logo" src="@urlCMS/@logo_header.image" alt="@logo_header.alt" />
                        </a>
                    </div>
                    <div class="col-lg-3 col-lg-3 col-md-6 cf-div hidden-sm hidden-xs hidden-md">
                        <div class="">
                            <div class="cf-img">
                                <img src="~/Assets/images/icon-time.png" />
                            </div>
                            <div class="contact-custom">
                                <h4>Lịch Tư Vấn</h4>
                                <h6>@contact.working_day | @contact.working_hour</h6>
                            </div>

                        </div>
                    </div>
                    <div class="col-lg-3 col-lg-3 col-md-6 cf-div hidden-sm hidden-xs hidden-md">
                        <div class="">
                            <div class="cf-img">
                                <img src="~/Assets/images/icon-phone.png" />
                            </div>
                            <div class="contact-custom">
                                <h4>Liên Hệ</h4>
                                <h6>@contact.phone_number</h6>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Start Navbar Area -->
    <div class="navbar-area">
        <div class="main-responsive-nav">
            <div class="container">
                <div class="main-responsive-menu">
                    <div class="show_contact_flex" style="display: flex">
                        <div>
                            <img src="~/Assets/images/icon-phone.png" style="width: 20%" />
                            <a href="/">
                                Tư vấn MIỄN PHÍ <br />
                                <span>@contact.phone_number</span>
                            </a>
                        </div>
                        <div style="margin-right:50px;">
                            <img src="~/Assets/images/icon-time.png" style="width:25%" />
                            <a href="/">
                                Làm Việc <br />
                                <span>8:00 - 20:00</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="main-navbar">
            <div class="container">
                <nav class="navbar navbar-expand-md navbar-light">
                    <div class="collapse navbar-collapse mean-menu" id="navbarSupportedContent">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a href="/" class="nav-link">
                                    <i class="flaticon-"></i> Trang chủ
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/pages/gioi-thieu" class="nav-link">
                                    Giới thiệu
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/pages/doi-ngu-bac-si" class="nav-link">
                                    Đội ngũ bác sĩ
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/pages/co-so-vat-chat" class="nav-link">
                                    Cơ sở vật chất
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/benh-nam-khoa" class="nav-link">
                                    Bệnh nam khoa
                                    <i class='bx bx-chevron-down'></i>
                                </a>

                                <ul class="dropdown-menu">
                                    @foreach (var bnk in list_benh_nam_khoa)
                                    {
                                        var list_category_child = new CategoryProvider().getByCategoryParentId(bnk.category_id);
                                        if (list_category_child.Count > 0)
                                        {
                                            <li class="nav-item">
                                                <a href="/category/@bnk.seo_alias" class="nav-link">
                                                    @bnk.category_name <i class='bx bx-chevron-down'></i>
                                                </a>
                                                <ul class="dropdown-menu">
                                                    @foreach (var cc in list_category_child)
                                                    {
                                                        if (cc.status == true && cc.show_datetime <= DateTime.Now)
                                                        {
                                                            <li class="nav-item">
                                                                <a href="/category/@cc.seo_alias" class="nav-link">
                                                                    @cc.category_name
                                                                </a>
                                                            </li>
                                                        }
                                                    }
                                                </ul>
                                            </li>
                                        }
                                        else
                                        {
                                            <li class="nav-item">
                                                <a href="/category/@bnk.seo_alias" class="nav-link">
                                                    @bnk.category_name
                                                </a>
                                            </li>
                                        }

                                    }
                                </ul>
                            </li>

                            <li class="nav-item">
                                <a href="/benh-xa-hoi" class="nav-link">
                                    Bệnh xã hội
                                    <i class='bx bx-chevron-down'></i>
                                </a>

                                <ul class="dropdown-menu">
                                    @foreach (var bxh in list_benh_xa_hoi)
                                    {
                                        var list_category_child = new CategoryProvider().getByCategoryParentId(bxh.category_id);
                                        if (list_category_child.Count > 0)
                                        {
                                            <li class="nav-item">
                                                <a href="/category/@bxh.seo_alias" class="nav-link">
                                                    @bxh.category_name <i class='bx bx-chevron-down'></i>
                                                </a>
                                                <ul class="dropdown-menu">
                                                    @foreach (var cc in list_category_child)
                                                    {
                                                        if (cc.status == true && cc.show_datetime <= DateTime.Now)
                                                        {
                                                            <li class="nav-item">
                                                                <a href="/category/@cc.seo_alias" class="nav-link">
                                                                    @cc.category_name
                                                                </a>
                                                            </li>
                                                        }
                                                    }
                                                </ul>
                                            </li>
                                        }
                                        else
                                        {
                                            <li class="nav-item">
                                                <a href="/category/@bxh.seo_alias" class="nav-link">
                                                    @bxh.category_name
                                                </a>
                                            </li>
                                        }

                                    }
                                </ul>
                            </li>

                            <li class="nav-item">
                                <a href="@map_link" class="nav-link" target="_blank">
                                    Chỉ đường
                                </a>
                            </li>
                        </ul>

                        <div class="others-options d-flex align-items-center">
                            <div class="option-item">
                                <a href="javascript:void(0)" onclick="showModal()" class="default-btn" id="show-modal-form">ĐẶT LỊCH HẸN</a>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </div>
    <!-- End Navbar Area -->

    @RenderBody()
    <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <div class="modal-header">
                <h4>Đặt lịch hẹn online</h4>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form>
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="form-group">
                                <label>Tên của bạn <span class="require">* </span></label>
                                <input id="mname" type="text" class="form-control" placeholder="Nhập tên của bạn tại đây">
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <div class="form-group">
                                <label>Số điện thoại <span class="require">* </span></label>
                                <input id="mphone" type="text" class="form-control" placeholder="Nhập số điện thoại của bạn tại đây">
                            </div>
                        </div>

                        <div class="col-lg-12 col-sm-12">
                            <div class="form-group">
                                <label>Nhập ngày tháng <span class="require">* </span></label>
                                <input id="datetimepicker" type="text" class="form-control datepicker" placeholder="@DateTime.Now.ToString("dd.MM.yyyy")">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button href="javascript:void(0)" class="default-btn" id="btn_dat_lich_modal" onclick="sendMessageModal()">GỬI THÔNG TIN</button>
            </div>
        </div>
    </div>

    <script>
        function sendMessageModal() {
            var cphone = $("#mphone").val();
            var cemail = "";
            var cname = $("#mname").val();
            var cmessage = "Đặt lịch hẹn";
            var csubject = $('.datepicker').val();
            if (cname == "" || cname == null) {
                alert("Yêu cầu nhập tên trước khi gửi");
            }
            else if (cphone == "") {
                alert("Yêu cầu nhập số điện thoại trước khi gửi");
            }
            else if (!phonenumber(cphone)) {
                alert("Số điện thoại không đúng định dạng");
            }
            else if (csubject == "") {
                alert("Yêu cầu nhập ngày đặt lịch trước khi gửi");
            }
            else {
                $.ajax({
                    type: "POST",
                    url: "/Page/SendMessage",
                    data: {
                        sender_name: cname,
                        sender_phone_number: cphone,
                        sender_email: cemail,
                        sender_subject: csubject,
                        sender_message: cmessage,
                    },
                    context: document.body,
                    dataType: "html",
                    beforeSend: function () {
                        $('#btn_dat_lich_modal').prop('disabled', true);
                        $('#btn_dat_lich_modal').text("ĐANG GỬI...");
                    },
                    success: function (data) {
                        $("#cname").val("");
                        $("#cphone").val("");
                        $("#datetimepicker").val("");
                        alert("Thông tin của bạn đã được gửi cho chúng tôi. Chúng tôi sẽ liên hệ lại với bạn. Cảm ơn bạn đã quan tâm!");
                    },
                    error: function (xhr, status) {
                        alert("Có lỗi xảy ra.");
                    },
                    complete: function (xhr, status) {
                        $('#btn_dat_lich_modal').text("GỬI THÔNG TIN");
                        $('#btn_dat_lich_modal').prop('disabled', false);
                    }
                });
            }
        }
    </script>

    <!-- Start Footer Area -->
    <div class="container container-footer hidden-sm hidden-xs">
        <div class="row">
            <div class="col-lg-3 col-md-6 box-contact-footer">
                <div class="single-stats-box">
                    <div class="icon">
                        <i class="flaticon-phone-call"></i>
                    </div>
                    <h3><a href="tel:@contact.phone_number.Trim()">@contact.phone_number</a></h3>
                    <p>Tư vấn miễn phí</p>
                </div>
            </div>

            <div class="col-lg-3 col-md-6 box-contact-footer">
                <div class="single-stats-box">
                    <div class="icon">
                        <i class="flaticon-appointment"></i>
                    </div>
                    <h3><a href="javascript:void(0)" onclick="showModal()">Đặt lịch khám online</a></h3>
                    <p>Trò chuyện cùng chuyên gia</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 box-contact-footer">
                <div class="single-stats-box">
                    <div class="icon">
                        <i class="flaticon-wall-clock"></i>
                    </div>
                    <h3>Mở cửa: @contact.working_hour</h3>
                    <p>Tất cả các ngày trong tuần</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 box-contact-footer">
                <div class="single-stats-box">
                    <div class="icon">
                        <i class="flaticon-pin"></i>
                    </div>
                    <h3><a href="@map_link" target="_blank">Chỉ đường</a></h3>
                    <p>Bản đồ đến phòng khám</p>
                </div>
            </div>
        </div>
    </div>
    <section class="footer-area bg-color pt-100 pb-70">

        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-sm-6">
                    <div class="single-footer-widget">
                        <a href="index.html">
                            <img src="@urlCMS/@logo_footer.image" alt="@logo_footer.alt">
                        </a>
                        <p>Với sự nỗ lực không ngừng, Phòng khám Đa khoa Bách Giai cam kết mang đến những dịch vụ chăm sóc sức khỏe hoàn hảo nhất, xứng danh là “Nơi gửi trọn niềm tin” của quý khách hàng.</p>

                        <ul class="footer-social">
                            <li>
                                <a href="/" target="_blank">
                                    <i class='bx bxl-facebook'></i>
                                </a>
                            </li>
                            <li>
                                <a href="/" target="_blank">
                                    <i class='bx bxl-twitter'></i>
                                </a>
                            </li>
                            <li>
                                <a href="/" target="_blank">
                                    <i class='bx bxl-pinterest-alt'></i>
                                </a>
                            </li>
                            <li>
                                <a href="/" target="_blank">
                                    <i class='bx bxl-linkedin'></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="col-lg-3 col-sm-6">
                    <div class="single-footer-widget pl-5">
                        <h2>Về chúng tôi</h2>

                        <ul class="opening-hours">
                            <li>
                                <a href="/pages/gioi-thieu">Giới thiệu</a>
                            </li>
                            <li>
                                <a href="/pages/doi-ngu-bac-si">Đội ngũ bác sĩ</a>
                            </li>
                            <li>
                                <a href="/pages/co-so-vat-chat">Cơ sở vật chất</a>
                            </li>
                            <li>
                                <a href="@map_link" target="_blank">Chỉ đường</a>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="col-lg-3 col-sm-6">
                    <div class="single-footer-widget">
                        <h2>Diện bệnh chính</h2>
                        <ul class="opening-hours">
                            @foreach (var benh in list_benh_chinh.Take(5).ToList())
                            {
                                <li>
                                    <a>@benh.category_name</a>
                                </li>
                            }
                        </ul>
                    </div>
                </div>

                <div class="col-lg-3 col-sm-6">
                    <div class="single-footer-widget pl-5">
                        <h2>Get In Touch</h2>

                        <ul class="footer-contact-info">

                            <li>
                                <i class='bx bxs-phone'></i>
                                <span>Điện Thoại</span>
                                <a href="tel:@contact.phone_number">@contact.phone_number</a>
                            </li>
                            <li>
                                <i class='bx bx-envelope'></i>
                                <span>Email</span>
                                <a href="mailto:@contact.email">@contact.email</a>
                            </li>
                            <li>
                                <i class='bx bx-map'></i>
                                <span>Địa chỉ</span>
                                @contact.address
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- End Footer Area -->
    <div class="hotline-phone-ring hidden-sm hidden-xs">
        <div class="hotline-phone-ring-circle"></div>
        <div class="hotline-phone-ring-circle-fill"></div>
        <div class="hotline-phone-ring-img-circle">
            <a href="tel:@contact.phone_number" class="pps-btn-img">
                <i style="color:#fff;font-size:15px;" class="flaticon-phone-call"></i>
            </a>
        </div>
    </div>
    <!-- Start Copy Right Area -->
    <div class="copyright-area bg-color">
        <div class="container">
            <div class="copyright-area-content">
                <p>
                    Bản quyền thuộc về Phòng khám Đa khoa
                    <a href="https://dakhoabachgiai.vn/" target="_blank">
                        Bách Giai 813 
                    </a>
                    Giải Phóng
                </p>
            </div>
        </div>
    </div>
    <!-- End Copy Right Area -->
    <!-- Start Go Top Area -->
    <div class="go-top">
        <i class='bx bx-up-arrow-alt'></i>
    </div>
    <!-- End Go Top Area -->

    <ul id="fixleft" class="hidden-sm hidden-xs">
        <a href="@link_chat" target="_blank"></a>
        <a href="@zalo_link" target="_blank"></a>
    </ul>

    <ul id="fixbot">
        <a href="tel:@contact.phone_number" class="m-convertion">
            @contact.phone_number
        </a>
        <a class="btndathen" onclick="showModal()">
            Đặt Lịch Hẹn
        </a>
        <a href="@link_chat" class="icchat m-convertion" target="_blank">
            Tư Vấn Online
        </a>
    </ul>
    @Scripts.Render("~/bundles/jsCoreSecond")
    <script>
        var width_device = $(window).width();
        jQuery(document).ready(function () {
            $("img.lazyload").lazyload();

            //if (width_device >= 1024) {
            //    var q2w3_sidebar_1_options = {
            //        "sidebar": "widget-area",
            //        "margin_top": 50,
            //        "margin_bottom": 1000,
            //        "screen_max_width": 0,
            //        "width_inherit": false,
            //        "widgets": ['widget_tag_cloud', 'widget_categories']
            //    };
            //    q2w3_sidebar(q2w3_sidebar_1_options);
            //    setInterval(function () { q2w3_sidebar(q2w3_sidebar_1_options); }, 1500);
            //}
        });

        function showModal() {
            var modal = document.getElementById("myModal");
            modal.style.display = "block";
        }

        function sendMessage() {
            var cphone = $("#cphone").val();
            var cemail = "";
            var cname = $("#cname").val();
            var cmessage = "Đặt lịch hẹn";
            var csubject = $('#datetimepicker').val();
            if (cname == "" || cname == null) {
                alert("Yêu cầu nhập tên trước khi gửi");
            }
            else if (cphone == "") {
                alert("Yêu cầu nhập số điện thoại trước khi gửi");
            }
            else if (!phonenumber(cphone)) {
                alert("Số điện thoại không đúng định dạng");
            }
            else if (csubject == "") {
                alert("Yêu cầu nhập ngày đặt lịch trước khi gửi");
            }
            else {
                $.ajax({
                    type: "POST",
                    url: "/Page/SendMessage",
                    data: {
                        sender_name: cname,
                        sender_phone_number: cphone,
                        sender_email: cemail,
                        sender_subject: csubject,
                        sender_message: cmessage,
                    },
                    context: document.body,
                    dataType: "html",
                    beforeSend: function () {
                        $('#btn-submit').prop('disabled', true);
                        $('#btn-submit').text("Đang Gửi...");
                    },
                    success: function (data) {
                        $("#cname").val("");
                        $("#cphone").val("");
                        $("#datetimepicker").val("");
                        alert("Thông tin của bạn đã được gửi cho chúng tôi. Chúng tôi sẽ liên hệ lại với bạn. Cảm ơn bạn đã quan tâm!");
                    },
                    error: function (xhr, status) {
                        alert("Có lỗi xảy ra.");
                    },
                    complete: function (xhr, status) {
                        $('#btn-submit').text("Đăng Ký Ngay");
                        $('#btn-submit').prop('disabled', false);
                    }
                });
            }
        }

        function phonenumber(inputtxt) {
            var phoneno = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
            if (inputtxt.match(phoneno)) {
                return true;
            }
            else {
                return false;
            }
        }

        function isEmail(email) {
            var regex = /^([a-zA-Z0-9_.+-])+\@@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            return regex.test(email);
        }

        //// Get the modal
        //var modal = document.getElementById("myModal");

        //// Get the button that opens the modal
        //var btn = document.getElementById("show-modal-form");

        //// Get the <span> element that closes the modal
        //var span = document.getElementsByClassName("close")[0];

        //// When the user clicks the button, open the modal
        //btn.onclick = function () {
        //    modal.style.display = "block";
        //}

        //// When the user clicks on <span> (x), close the modal
        //span.onclick = function () {
        //    modal.style.display = "none";
        //}

        //// When the user clicks anywhere outside of the modal, close it
        //window.onclick = function (event) {
        //    if (event.target == modal) {
        //        modal.style.display = "none";
        //    }
        //}
    </script>
</body>
</html>